(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      4552,        147]
NotebookOptionsPosition[      4294,        133]
NotebookOutlinePosition[      4653,        149]
CellTagsIndexPosition[      4610,        146]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", "5", ",", "100"}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"Ds", ",", "Phis", ",", "m", ",", "tmax"}], "}"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"th", ",", "tl", ",", "Jh", ",", "Jl"}], "}"}], "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.1", ",", "0.05", ",", "0.1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"kappa", ",", "gamma"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Erbeta", "=", "20"}], ";", 
    RowBox[{"beta", "=", "40"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Edotr", "=", "0.1"}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"10", "^", "6"}], "*", 
    RowBox[{"ev", "/", "cm"}], " ", "*", " ", "5", "nm"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"beta", "=", "20"}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"beta", "=", 
     RowBox[{
      RowBox[{"40", " ", "for", " ", "Temp"}], "=", "0.025"}]}], ";", " ", 
    RowBox[{"for", " ", "300", "K"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Erbeta", "=", 
   RowBox[{"Edotr", "*", "beta"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Erbeta = \>\"", ",", "Erbeta"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxiter", "=", "100"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gs", "=", 
   RowBox[{"{", 
    RowBox[{"0.05", ",", "0.1", ",", "0.5", ",", "1", ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<================= gg = \>\"", ",", "gg", ",", 
       "\"\<=================\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"trajectory", "[", 
       RowBox[{
       "5", ",", "vars", ",", "gg", ",", "th", ",", "tl", ",", "Jh", ",", 
        "Jl", ",", "kappa", ",", "gamma", ",", "maxiter"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"out", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"AppendTo", "[", 
      RowBox[{"res", ",", "x"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"gg", ",", "gs"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mean", "=", 
   RowBox[{"Mean", "[", 
    RowBox[{"res", "//", "Transpose"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<mean = \>\"", ",", "mean"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"x", "=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "gs", "}"}], "//", "Transpose"}], ",", 
     RowBox[{
      RowBox[{"{", "mean", "}"}], "//", "Transpose"}], ",", "2"}], "]"}], "//",
    "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"x", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", 
    RowBox[{"{", "\"\<X\>\"", "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.707487047990239*^9, 3.707487051769538*^9}}]
},
WindowSize->{808, 699},
WindowMargins->{{Automatic, 252}, {-4, Automatic}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3732, 111, 420, "Input"]
}
]
*)

(* End of internal cache information *)

