(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     21793,        558]
NotebookOptionsPosition[     21475,        542]
NotebookOutlinePosition[     21865,        559]
CellTagsIndexPosition[     21822,        556]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalPi]", " ", "+", " ", "D"}], "|", 
      RowBox[{"Phi", " ", "+", " ", "A"}]}], " ", "\[Rule]", " ", 
     RowBox[{"\[CapitalPi]", " ", "+", " ", 
      RowBox[{"A", "'"}]}]}], " ", "*)"}],
   FontSize->18], 
  StyleBox["\[IndentingNewLine]",
   FontSize->18], 
  StyleBox["\[IndentingNewLine]",
   FontSize->18], 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"Jh", ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Jl", " ", "for", " ", 
        RowBox[{"contacts", ":", " ", "\[IndentingNewLine]", 
         RowBox[{
         "no", " ", "interference", " ", "terms", " ", "for", " ", "the", " ",
           "contact", " ", "processes", " ", "btw", " ", "Jl"}]}]}], " ", 
       "&"}], " ", "Jh", "\[IndentingNewLine]", "So"}], ",", " ", 
     RowBox[{
     "just", " ", "deal", " ", "with", " ", "them", " ", "seperately"}]}], 
    "*)"}],
   FontSize->18], 
  StyleBox["\[IndentingNewLine]",
   FontSize->18], 
  StyleBox["\[IndentingNewLine]",
   FontSize->24], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14], 
  StyleBox[
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Jl", ":", " ", 
       RowBox[{"\[CapitalPi]", " ", "+", " ", "D", " ", "+", " ", 
        RowBox[{"A", "[", 
         RowBox[{"N", ",", "m"}], "]"}]}]}], " ", "\[Rule]", " ", 
      RowBox[{"\[CapitalPi]", " ", "+", " ", 
       RowBox[{"A", "[", 
        RowBox[{
         RowBox[{"N", "+", "1"}], ",", "m"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Jh", ":", " ", 
       RowBox[{"\[CapitalPi]", " ", "+", " ", "D", " ", "+", " ", 
        RowBox[{"A", "[", 
         RowBox[{"N", ",", "m"}], "]"}]}]}], " ", "\[Rule]", " ", 
      RowBox[{"\[CapitalPi]", " ", "+", " ", 
       RowBox[{"A", "[", 
        RowBox[{
         RowBox[{"N", "+", "1"}], ",", 
         RowBox[{"m", "+", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
    "*)"}],
   FontSize->14], 
  StyleBox["\[IndentingNewLine]",
   FontSize->14], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"D", "/", "Phi"}], " ", "site", " ", "turning", " ", "to", " ", 
    "active", " ", "goes", " ", "to", " ", "the", " ", "end", " ", "of", " ", 
    "active", " ", 
    RowBox[{"list", "."}]}], "*)"}], "\[IndentingNewLine]", 
  StyleBox["\[IndentingNewLine]",
   FontSize->14], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mapCDA", "[", 
      RowBox[{"N_", ",", "k_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "x1", ",", "x2", ",", "listi", ",", "tab1", ",", "tab2", ",", "set1", 
         ",", "listf"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tab1", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"tab2", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"listi", "=", 
         RowBox[{"comb", "[", 
          RowBox[{"N", ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", ",", "k"}], ")"}], ":", " ", "ind"}], " ", "=", " ", 
          
          RowBox[{
           RowBox[{"c", "[", 
            RowBox[{"n", ",", "k"}], "]"}], "-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"n", "-", 
                RowBox[{"listi", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"k", "-", "j"}]}], " ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "0", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"set1", "=", 
            RowBox[{"listi", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"listf", "=", 
            RowBox[{"Sort", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"set1", ",", 
               RowBox[{"{", 
                RowBox[{"N", "+", "1"}], "}"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "add", " ", "an", " ", "up", " ", "site", " ", "at", " ", "last", 
             " ", "position"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"x1", "=", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"N", "+", "1"}], ",", 
               RowBox[{"k", "+", "1"}]}], "]"}], "-", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{
                 RowBox[{"N", "+", "1", "-", 
                  RowBox[{"listf", "[", 
                   RowBox[{"[", 
                    RowBox[{"p", "+", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{"k", "+", "1", "-", "p"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"p", ",", "0", ",", "k"}], "}"}]}], "]"}]}]}], ";", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{"for", " ", "adding", " ", "an", " ", "up", " ", "site"}],
             " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"x2", "=", 
            RowBox[{
             RowBox[{"c", "[", 
              RowBox[{
               RowBox[{"N", "+", "1"}], ",", "k"}], "]"}], "-", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{
                 RowBox[{"N", "+", "1", "-", 
                  RowBox[{"set1", "[", 
                   RowBox[{"[", 
                    RowBox[{"p", "+", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{"k", "-", "p"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"p", ",", "0", ",", 
                 RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{
            "for", " ", "adding", " ", "a", " ", "down", " ", "site"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tab1", ",", "x1"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tab2", ",", "x2"}], "]"}], ";"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "listi", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"tab1", ",", "tab2"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->24], 
   StyleBox["\[IndentingNewLine]",
    FontSize->24], 
   RowBox[{
    RowBox[{
     RowBox[{"makeHtCDAN0", "[", "m_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ntot0", ",", "ntot1", ",", "ntot2", ",", "Htsph", ",", "Htspl"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ntot0", "=", "1"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"init", " ", "state"}], ",", " ", 
          RowBox[{"tot", " ", "num", " ", "of", " ", "basis"}]}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"ntot1", "=", "2"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"Jh", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ntot2", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m", "\[Equal]", "0"}], ",", "1", ",", "2"}], "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"Jl", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Htsph", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", " ", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"ntot0", ",", "ntot1"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"(*", " ", "Jh", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Htspl", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", " ", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"ntot0", ",", "ntot2"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"(*", " ", "Jl", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Htsph", ",", "Htspl"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Seperate", " ", "blocks", " ", "of", " ", "Jh"}], ",", 
     RowBox[{
      RowBox[{"Jl", " ", "terms"}], ";", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "for", " ", "makeHtCPhiA", " ", "just", " ", "switch", " ", "Jh"}], 
        "&"}], "Jl", " ", "in", " ", "the", " ", "two", " ", "blocks"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"makeHtCDA", "[", 
      RowBox[{"N_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pntr0", ",", "pntr1", ",", "pntr2", ",", "ind0", ",", "ntot0", ",", 
         "Hta", ",", "Htb", ",", "ind1", ",", "ind2", ",", "coora", ",", 
         "coorb", ",", "ntot1", ",", "Htsph", ",", "Htspl", ",", "ntot2", ",",
          "tab1", ",", "tab2", ",", "m1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"N", "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Htsph", ",", "Htspl"}], "}"}], "=", 
           RowBox[{"makeHtCDAN0", "[", "m", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"pointers", " ", "for", " ", "start", " ", "index"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m1", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"m", ",", "N"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pntr0", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"N", ",", "j"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", "m1"}], "}"}]}], "]"}], ",", "0",
               ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pntr1", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{
                    RowBox[{"N", "+", "1"}], ",", "j"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"m", "+", "1"}], ",", 
                    RowBox[{"N", "+", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
              "0", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pntr2", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{
                    RowBox[{"N", "+", "1"}], ",", "j"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "0", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"N", "+", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
              "0", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"pntr0", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"N", ",", "j"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}], ",", 
                "0", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pntr1", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{
                    RowBox[{"N", "+", "1"}], ",", "j"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "0", ",", 
                    RowBox[{"m", "+", "1"}]}], "}"}]}], "]"}], ",", "0", ",", 
                "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pntr2", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{
                    RowBox[{"N", "+", "1"}], ",", "j"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "0", ",", "i"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}], ",", 
                "0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
            "*)"}], 
           RowBox[{"ntot0", "=", 
            RowBox[{"pntr0", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"ntot1", "=", 
            RowBox[{"pntr1", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
           RowBox[{"ntot2", "=", 
            RowBox[{"pntr2", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"Hta", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"Htb", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ind0", "=", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"pntr0", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", 
                  RowBox[{"Table", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"N", ",", "k"}], "]"}]}], "}"}]}], "]"}]}], "}"}],
                 "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"tab1", ",", "tab2"}], "}"}], "=", 
               RowBox[{"mapCDA", "[", 
                RowBox[{"N", ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"ind1", "=", 
               RowBox[{
                RowBox[{"pntr1", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "2"}], "]"}], "]"}], "+", "tab1"}]}], ";",
               " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"m", "+", 
                 RowBox[{"1", " ", "final", " ", "excitations"}]}], ";", " ", 
                
                RowBox[{
                "shift", " ", "k", " ", "by", " ", "1", " ", "bcs", " ", 
                 "one", " ", "up", " ", "spin", " ", "added"}]}], " ", "*)"}],
               "\[IndentingNewLine]", 
              RowBox[{"ind2", "=", 
               RowBox[{
                RowBox[{"pntr2", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", "+", "1"}], "]"}], "]"}], "+", "tab2"}]}], ";",
               " ", 
              RowBox[{"(*", " ", 
               RowBox[{"m", " ", "final", " ", "excitations"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"ind1", "=", 
               RowBox[{
                RowBox[{"{", "ind1", "}"}], "//", "Transpose"}]}], ";", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Jh", " ", "for", " ", "D"}], ",", " ", 
                RowBox[{"Jl", " ", "for", " ", 
                 RowBox[{"Phi", ":", " ", 
                  RowBox[{"up", " ", "added"}]}]}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"ind2", "=", 
               RowBox[{
                RowBox[{"{", "ind2", "}"}], "//", "Transpose"}]}], ";", "  ", 
              
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"Jl", " ", "for", " ", "D"}], ",", " ", 
                RowBox[{"Jh", " ", "for", " ", 
                 RowBox[{"Phi", ":", " ", 
                  RowBox[{"dn", " ", "added"}]}]}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "tab1", "]"}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{"coora", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"ind0", ",", "ind1", ",", "2"}], "]"}]}], ";", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"Hta", ",", "coora"}], " ", "]"}], ";"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "tab2", "]"}], ">", "0"}], ",", 
                RowBox[{
                 RowBox[{"coorb", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"ind0", ",", "ind2", ",", "2"}], "]"}]}], ";", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"Htb", ",", "coorb"}], " ", "]"}], ";"}]}], "]"}], 
              ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "0", ",", "m1"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "Hta", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Hta", ",", "1"}], "]"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Htb", ",", "1"}], "]"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Htsph", "=", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Hta", ",", "1"}], "]"}], "\[Rule]", " ", "1"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"ntot0", ",", "ntot1"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"(*", " ", "Jh", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Htspl", "=", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Htb", ",", "1"}], "]"}], "\[Rule]", " ", "1"}], ",", 
              
              RowBox[{"{", 
               RowBox[{"ntot0", ",", "ntot2"}], "}"}]}], "]"}]}], ";"}]}], 
         RowBox[{"(*", " ", "Jl", " ", "*)"}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Htsph", ",", "Htspl"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontSize->24]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.714912227267303*^9, 3.714912240947157*^9}}]
},
AutoGeneratedPackage->Automatic,
WindowSize->{808, 706},
WindowMargins->{{Automatic, 68}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 20913, 520, 1372, "Input",
 InitializationCell->True]
}
]
*)

