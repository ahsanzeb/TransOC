(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9872,        258]
NotebookOptionsPosition[      9555,        242]
NotebookOutlinePosition[      9946,        259]
CellTagsIndexPosition[      9903,        256]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OneDLatticeWays", "[", 
    RowBox[{"Ntot_", ",", "Ds_", ",", "Phis_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "DhopsR", ",", "DhopsL", ",", "DPhiR", ",", "DPhiL", ",", 
       "\[IndentingNewLine]", "PhihopsR", ",", "PhihopsL", ",", "CDhopsR", 
       ",", "CDhopsL", ",", "\[IndentingNewLine]", "CPhihopsR", ",", 
       "CPhihopsL", ",", "LDs", ",", "LPhis", ",", "xD", ",", "xPhi", ",", 
       "Apairs", ",", "CAR", ",", "CAL"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"DhopsR", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"DhopsL", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"DPhiR", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"DPhiL", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PhihopsR", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"PhihopsL", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CDhopsR", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"CDhopsL", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"CPhihopsR", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"CPhihopsL", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CAL", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"CAR", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"Apairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"LDs", "=", 
       RowBox[{"Length", "[", "Ds", "]"}]}], ";", 
      RowBox[{"LPhis", "=", 
       RowBox[{"Length", "[", "Phis", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"find", " ", 
        RowBox[{"R", "/", "L"}], " ", "hops", " ", "for", " ", "Ds", " ", 
        "and", " ", "DPhi", " ", 
        RowBox[{"R", "/", "L"}], " ", "pairs"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"LDs", ">", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"xD", "=", 
             RowBox[{"Ds", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"Phis", ",", 
                RowBox[{"xD", "+", "1"}]}], "]"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"DPhiR", ",", "xD"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"xD", "\[NotEqual]", " ", "Ntot"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"Ds", ",", 
                   RowBox[{"xD", "+", "1"}]}], "]"}]}], ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"DhopsR", ",", "xD"}], "]"}]}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"Phis", ",", 
                RowBox[{"xD", "-", "1"}]}], "]"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"DPhiL", ",", "xD"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"xD", "\[NotEqual]", " ", "1"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"Ds", ",", 
                   RowBox[{"xD", "-", "1"}]}], "]"}]}], ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"DhopsL", ",", "xD"}], "]"}]}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xD", "\[Equal]", "1"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"CDhopsL", ",", "xD"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xD", "\[Equal]", "Ntot"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"CDhopsR", ",", "xD"}], "]"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "LDs"}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"find", " ", 
        RowBox[{"R", "/", "L"}], " ", "hops", " ", "for", " ", "Phis"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"LPhis", ">", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"xPhi", "=", 
             RowBox[{"Phis", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"FreeQ", "[", 
                RowBox[{"Phis", ",", 
                 RowBox[{"xPhi", "+", "1"}]}], "]"}], "&&", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"Ds", ",", 
                 RowBox[{"xPhi", "+", "1"}]}], "]"}], "&&", 
               RowBox[{"xPhi", "\[NotEqual]", " ", "Ntot"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"PhihopsR", ",", "xPhi"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"Phis", ",", 
                   RowBox[{"xPhi", "-", "1"}]}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{"Ds", ",", 
                   RowBox[{"xPhi", "-", "1"}]}], "]"}], "&&", 
                 RowBox[{"xPhi", "\[NotEqual]", " ", "1"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"PhihopsL", ",", "xPhi"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xPhi", "\[Equal]", "1"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"CPhihopsL", ",", "xPhi"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xPhi", "\[Equal]", "Ntot"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"CPhihopsR", ",", "xPhi"}], "]"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "LPhis"}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Apairs", ",", "CAR", ",", "CAL"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"Ds", ",", "Phis"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"i", "+", "1"}]}], "}"}]}], "]"}], "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"Apairs", ",", "i"}], "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Ntot", "-", "1"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"Ds", ",", "1"}], "]"}], "&&", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"Phis", ",", "1"}], "]"}]}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"CAL", ",", "1"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"Ds", ",", "Ntot"}], "]"}], "&&", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"Phis", ",", "Ntot"}], "]"}]}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"CAR", ",", "Ntot"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "DhopsR", ",", "DhopsL", ",", "PhihopsR", ",", "PhihopsL", ",", 
        "DPhiR", ",", "DPhiL", ",", "\[IndentingNewLine]", "CDhopsR", ",", 
        "CDhopsL", ",", "CPhihopsR", ",", "CPhihopsL", ",", "Apairs", ",", 
        "CAR", ",", "CAL"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True]
},
AutoGeneratedPackage->Automatic,
WindowSize->{808, 706},
WindowMargins->{{92, Automatic}, {-4, Automatic}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 8993, 220, 726, "Input",
 InitializationCell->True]
}
]
*)

