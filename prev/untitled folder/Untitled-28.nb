(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      3005,         91]
NotebookOptionsPosition[      2749,         77]
NotebookOutlinePosition[      3107,         93]
CellTagsIndexPosition[      3064,         90]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"kappa", " ", "and", " ", "gamma"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"m", ">", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ENmm1", ",", "UNmm1"}], "}"}], "=", 
        RowBox[{"DiagH", "[", 
         RowBox[{"N", ",", 
          RowBox[{"m", "-", "1"}], ",", "gg", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "kappa", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RkappaM", " ", "=", " ", 
        RowBox[{
         RowBox[{"HtKappa", "[", 
          RowBox[{"N", ",", "m"}], "]"}], ".", 
         RowBox[{"Transpose", "[", "UNmm1", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Rkappa", "=", 
        RowBox[{"psi", ".", "RkappaM"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"r13", "=", 
        RowBox[{
         RowBox[{"Norm", "[", "Rkappa", "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "gamma", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Rgamma", "[", "i", "]"}], " ", "=", " ", 
           RowBox[{"psi", ".", 
            RowBox[{"HtGamma", "[", 
             RowBox[{"N", ",", "m", ",", "i"}], "]"}], ".", 
            RowBox[{"Transpose", "[", "UNmm1", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"r14z", "[", "i", "]"}], "=", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"Rgamma", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"r14", "+=", 
           RowBox[{"r14z", "[", "i", "]"}]}], ";"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.706596016132307*^9, 3.706596358966666*^9}}]
},
WindowSize->{808, 695},
WindowMargins->{{Automatic, 189}, {2, Automatic}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2187, 55, 301, "Input"]
}
]
*)

