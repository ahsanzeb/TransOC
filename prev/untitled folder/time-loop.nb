(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    110478,       2752]
NotebookOptionsPosition[    110146,       2736]
NotebookOutlinePosition[    110534,       2753]
CellTagsIndexPosition[    110491,       2750]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SecRates", "[", 
    RowBox[{"Elevels_", ",", "rate_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i1", ",", "i2", ",", "Rlist", ",", "x", ",", "deg", ",", "nlevels", 
       ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i1", "=", "0"}], ";", 
      RowBox[{"i2", "=", "0"}], ";", 
      RowBox[{"x", "=", "0"}], ";", 
      RowBox[{"Rlist", "=", 
       RowBox[{"{", "0", "}"}]}], ";", 
      RowBox[{"deg", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nlevels", "=", 
       RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"i2", "+=", 
          RowBox[{"Elevels", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"deg", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"r", "=", 
          RowBox[{"rate", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i1", "+", "1"}], ";;", "i2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x", "+=", 
          RowBox[{
           RowBox[{"Norm", "[", "r", "]"}], "^", "2"}]}], ";", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"Rlist", ",", "x"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"i1", "=", "i2"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Rlist", ",", "deg"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7065499679307013`*^9, 3.706550050879017*^9}, {
  3.706550152548482*^9, 3.706550208730027*^9}, {3.706550534648505*^9, 
  3.706550588245892*^9}, {3.706550626094886*^9, 3.706550687731998*^9}, {
  3.7065507189159117`*^9, 3.706550738991967*^9}, {3.706551294165195*^9, 
  3.7065513504442167`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "get", " ", "total", " ", "rate", " ", "for", " ", "all", " ", 
     "processes"}], ",", " ", 
    RowBox[{
    "and", " ", "find", " ", "the", " ", "time", " ", "increment", " ", "for",
      " ", "the", " ", "quantum", " ", "jump"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "get", " ", "rates", " ", "for", " ", "current", " ", "state", " ", 
    "psi"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r1", "=", "0"}], ";", 
    RowBox[{"r2", "=", "0"}], ";", 
    RowBox[{"r3", "=", "0"}], ";", 
    RowBox[{"r4", "=", "0"}], ";", 
    RowBox[{"r5", "=", "0"}], ";", 
    RowBox[{"r6", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r7", "=", "0"}], ";", 
    RowBox[{"r8", "=", "0"}], ";", 
    RowBox[{"r9", "=", "0"}], ";", 
    RowBox[{"r10", "=", "0"}], ";", 
    RowBox[{"r11", "=", "0"}], ";", 
    RowBox[{"r12", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"D", " ", "hops", " ", 
     RowBox[{"R", "/", "L"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RDAM", " ", "=", 
        RowBox[{
         RowBox[{"HtDAR", "[", "i", "]"}], ".", 
         RowBox[{"Transpose", "[", "UNm", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RDAR", "[", "i", "]"}], "=", 
        RowBox[{"psi", ".", "RDAM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1z", "[", "i", "]"}], "=", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"RDAR", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r1", " ", "+=", " ", 
        RowBox[{"r1z", "[", "i", "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ldr"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RDAM", " ", "=", 
        RowBox[{
         RowBox[{"HtDAL", "[", "i", "]"}], ".", 
         RowBox[{"Transpose", "[", "UNm", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RDAL", "[", "i", "]"}], "=", 
        RowBox[{"psi", ".", "RDAM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r1bz", "[", "i", "]"}], "=", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"RDAL", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r1b", " ", "+=", 
        RowBox[{"r1bz", "[", "i", "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "ldl"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Phi", " ", "hops", " ", 
     RowBox[{"R", "/", "L"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RDAM", " ", "=", 
        RowBox[{
         RowBox[{"HtPhiAR", "[", "i", "]"}], ".", 
         RowBox[{"Transpose", "[", "UNm", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RPhiAR", "[", "i", "]"}], "=", 
        RowBox[{"psi", ".", "RDAM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r2z", "[", "i", "]"}], "=", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"RPhiAR", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r2", " ", "+=", " ", 
        RowBox[{"r2z", "[", "i", "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "lpr"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RDAM", " ", "=", 
        RowBox[{
         RowBox[{"HtPhiAL", "[", "i", "]"}], ".", 
         RowBox[{"Transpose", "[", "UNm", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RPhiAL", "[", "i", "]"}], "=", 
        RowBox[{"psi", ".", "RDAM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r2bz", "[", "i", "]"}], "=", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"RPhiAL", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r2b", " ", "+=", " ", 
        RowBox[{"r2bz", "[", "i", "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "lpl"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"D", ",", "Phi"}], ")"}], " ", "+", " ", "A"}], " ", "\[Rule]",
      " ", 
     RowBox[{"A", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ldpr", "=", 
     RowBox[{"Length", "[", "DPhiR", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ldpl", "=", 
     RowBox[{"Length", "[", "DPhiL", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ldpa", "=", 
     RowBox[{"ldpr", "+", "ldpl"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ldpa", ">", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RDPhiA", "=", 
        RowBox[{"psi", ".", "RDPhiAM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r3z", "=", 
        RowBox[{
         RowBox[{"Norm", "[", "RDPhiA", "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r3", " ", "=", " ", 
        RowBox[{"ldpa", "*", "r3z"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"inv", " ", 
      RowBox[{"processes", ":", " ", "A"}]}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"D", ",", "Phi"}], ")"}], "+", "A"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"only", " ", "D"}], ",", 
      RowBox[{"Phi", " ", "pairs"}], ",", " ", 
      RowBox[{"currently", " ", "not", " ", "Phi"}], ",", 
      RowBox[{"D", " ", "pairs"}], ",", " ", 
      RowBox[{"do", " ", "it", " ", "later"}]}], " ", "*)"}],
    FontSize->8], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RDPhiAinvM", "=", 
        RowBox[{
         RowBox[{"HtApairs", "[", "i", "]"}], ".", "UNm2mm1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RDPhiAinv", "[", "i", "]"}], "=", 
        RowBox[{"psi", ".", "RDPhiAinvM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r4z", "[", "i", "]"}], "=", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"RDPhiAinv", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r4", "+=", 
        RowBox[{"r4z", "[", "i", "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "lApairs"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"contacts", ":", " ", 
      RowBox[{
      "use", " ", "these", " ", "D", " ", "rates", " ", "for", " ", "phis", 
       " ", "as", " ", "well"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"just", " ", "jh"}], "&"}], "jl", " ", "interchanged"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"CDhopsR", ",", "CDhopsL", ",", "CPhihopsR", ",", "CPhihopsL"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ldacproc", ">", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RCDAh", "=", 
        RowBox[{"psi", ".", "RCDAhM"}]}], ";", 
       RowBox[{"RCDAl", "=", 
        RowBox[{"psi", ".", "RCDAlM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{
         RowBox[{"Norm", "[", "RCDAh", "]"}], "^", "2"}]}], ";", 
       RowBox[{"x2", "=", 
        RowBox[{
         RowBox[{"Norm", "[", "RCDAl", "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"rates", " ", "for", " ", "D", " ", "and", " ", "Phi"}], ";",
          " ", 
         RowBox[{
         "add", " ", "bprob", " ", "not", " ", "amplitudes", " ", "because", 
          " ", "diff", " ", "final", " ", "Hilbert", " ", "spaces"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rcd", "=", 
        RowBox[{
         RowBox[{"x1", "*", "Jh"}], " ", "+", " ", 
         RowBox[{"x2", "*", "Jl"}]}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"rcp", "=", 
        RowBox[{
         RowBox[{"x1", "*", "Jl"}], " ", "+", " ", 
         RowBox[{"x2", "*", "Jh"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lcdr", ">", "0"}], ",", 
         RowBox[{"r5", "=", "rcd"}]}], "]"}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"for", " ", "left", " ", "contact"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lcdl", ">", "0"}], ",", 
         RowBox[{"r6", "=", "rcd"}]}], "]"}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"for", " ", "right", " ", "contact"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lcpr", ">", "0"}], ",", 
         RowBox[{"r7", "=", "rcp"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lcpl", ">", "0"}], ",", 
         RowBox[{"r8", "=", "rcp"}]}], "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"r5x", "=", "x1"}], ";", 
       RowBox[{"r6x", "=", "x2"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"inv", " ", "process", " ", "at", " ", "contacts"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RCAhM", "=", 
        RowBox[{
         RowBox[{"HtCAh", "[", "i", "]"}], ".", "UNm1mm1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RCAlM", "=", 
        RowBox[{
         RowBox[{"HtCAl", "[", "i", "]"}], ".", "UNm1m"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RCAh", "[", "i", "]"}], "=", 
        RowBox[{"psi", ".", "RCAhM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RCAl", "[", "i", "]"}], "=", 
        RowBox[{"psi", ".", "RCAlM"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"RCAh", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x2", "=", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"RCAl", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rcdi", "=", 
        RowBox[{
         RowBox[{"x1", "*", "Jh"}], " ", "+", " ", 
         RowBox[{"x2", "*", "Jl"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rcpi", "=", 
        RowBox[{
         RowBox[{"x1", "*", "Jl"}], " ", "+", " ", 
         RowBox[{"x2", "*", "Jh"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"for", " ", "left", " ", "contact"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CAproc", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"r9", "=", "rcdi"}], ";", 
          RowBox[{"r11", "=", "rcpi"}], ";", "\[IndentingNewLine]", 
          RowBox[{"r9xh", "=", "x1"}], ";", 
          RowBox[{"r9xl", "=", "x2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"r11xh", "=", "x1"}], ";", 
          RowBox[{"r11xl", "=", "x2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"r9i", "=", "i"}], ";", 
          RowBox[{"r11i", "=", "i"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"for", " ", "right", " ", "contact"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CAproc", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "Ntot"}], ",", 
         RowBox[{
          RowBox[{"r10", "=", "rcdi"}], ";", 
          RowBox[{"r12", "=", "rcpi"}], ";", "\[IndentingNewLine]", 
          RowBox[{"r10xh", "=", "x1"}], ";", 
          RowBox[{"r10xl", "=", "x2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"r12xh", "=", "x1"}], ";", 
          RowBox[{"r12xl", "=", "x2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"r10i", "=", "i"}], ";", 
          RowBox[{"r12i", "=", "i"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "lcAp"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"kappa", " ", "and", " ", "gamma"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"m", ">", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ENmm1", ",", "UNmm1"}], "}"}], "=", 
        RowBox[{"DiagH", "[", 
         RowBox[{"N", ",", 
          RowBox[{"m", "-", "1"}], ",", "gg", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "kappa", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RkappaM", " ", "=", " ", 
        RowBox[{
         RowBox[{"HtKappa", "[", 
          RowBox[{"N", ",", "m"}], "]"}], ".", 
         RowBox[{"Transpose", "[", "UNmm1", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Rkappa", "=", 
        RowBox[{"psi", ".", "RkappaM"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"r13", "=", 
        RowBox[{
         RowBox[{"Norm", "[", "Rkappa", "]"}], "^", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "gamma", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Rgamma", "[", "i", "]"}], " ", "=", " ", 
           RowBox[{"psi", ".", 
            RowBox[{"HtGamma", "[", 
             RowBox[{"N", ",", "m", ",", "i"}], "]"}], ".", 
            RowBox[{"Transpose", "[", "UNmm1", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"r14z", "[", "i", "]"}], "=", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"Rgamma", "[", "i", "]"}], "]"}], "^", "2"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"r14", "+=", 
           RowBox[{"r14z", "[", "i", "]"}]}], ";"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"make", " ", "a", " ", "single", " ", 
     RowBox[{"list", "/", "array"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rates", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r1z", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ldr"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r1bz", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ldl"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r2z", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "lpr"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r2bz", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "lpl"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"r3z", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "ldpr"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{"r3z", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "ldpl"}], "}"}]}], "]"}], ","}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", "r3z", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r4z", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "lApairs"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"r5", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "lcdr"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{"r6", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "lcdl"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{"r7", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "lcpr"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{"r8", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "lcpl"}], "}"}]}], "]"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", "r5", "}"}], ",", 
       RowBox[{"{", "r6", "}"}], ",", 
       RowBox[{"{", "r7", "}"}], ",", 
       RowBox[{"{", "r8", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "r9", "}"}], ",", 
       RowBox[{"{", "r10", "}"}], ",", 
       RowBox[{"{", "r11", "}"}], ",", 
       RowBox[{"{", "r12", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "r13", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"r14z", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"total", " ", "rate", " ", "etc"}], ";", " ", 
     RowBox[{"add", " ", 
      RowBox[{"kappa", "/", 
       RowBox[{"gamma", " ", "!"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"totrates", "=", 
     RowBox[{"{", 
      RowBox[{
      "r1", ",", "r1b", ",", "r2", ",", "r2b", ",", "r3", ",", "r4", ",", 
       "r5", ",", "r6", ",", "r7", ",", "r8", ",", "r9", ",", "r10", ",", 
       "r11", ",", "r12", ",", "r13", ",", "r14"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ltotr", "=", 
     RowBox[{"Length", "[", "totrates", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", "=", " ", 
     RowBox[{"Total", "[", "totrates", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"slist", "=", 
     RowBox[{"Insert", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"totrates", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "i"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "ltotr"}], "}"}]}], "]"}], ",", "0", 
       ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"time", " ", "increment"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"dt", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "R"}], " ", ")"}], "*", 
      RowBox[{"Log", "[", "u", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"which", " ", 
      RowBox[{"process", ":", " ", "whichjump"}]}], "=", "?"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eta", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "R"}], " ", "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"eta", ">", 
          RowBox[{"slist", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
         RowBox[{"eta", "\[LessEqual]", "  ", 
          RowBox[{"slist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"whichjump", "=", "i"}], ";", 
         RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ltotr"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"which", " ", "sites", " ", "for", " ", "selected", " ", 
      RowBox[{"jump", "?"}]}], ":", " ", 
     RowBox[{"whichsites", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"process", "=", 
     RowBox[{"rates", "[", 
      RowBox[{"[", "whichjump", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"lp", "=", 
     RowBox[{"Length", "[", "process", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"slist", "=", 
     RowBox[{"Insert", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"process", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "i"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "lp"}], "}"}]}], "]"}], ",", "0", ",", 
       "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eta", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Total", "[", "process", "]"}]}], " ", "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"eta", ">", 
          RowBox[{"slist", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
         RowBox[{"eta", "\[LessEqual]", "  ", 
          RowBox[{"slist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"whichsites", "=", "i"}], ";", 
         RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "lp"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"which", " ", "final", " ", 
      RowBox[{"state", "/", "degenerate"}], " ", 
      RowBox[{"sector", "?"}]}], ":", " ", 
     RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"update", " ", "Ds"}], ",", " ", 
        RowBox[{"positions", " ", "of", " ", "D", " ", "sites"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos", 
        StyleBox["=",
         FontSize->14], 
        RowBox[{"DhopsR", "[", 
         RowBox[{"[", "whichsites", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ds", "=", 
        RowBox[{"Ds", "/.", 
         RowBox[{"{", 
          RowBox[{"pos", "\[Rule]", " ", 
           RowBox[{"pos", "+", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rate", "=", 
        RowBox[{"RDAR", "[", "whichsites", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Elevels", "=", 
        RowBox[{
         RowBox[{"Tally", "[", "ENm", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlevels", "=", 
        RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
        RowBox[{"SecRates", "[", 
         RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"which", " ", 
          RowBox[{"sector", "?"}]}], ":", " ", 
         RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Rlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", ">", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
            RowBox[{"eta", "\[LessEqual]", "  ", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"whichsec", "=", "i"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "=", 
        RowBox[{"degen", "[", 
         RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"psif", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"UNm", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"update", " ", "Ds"}], ",", " ", 
        RowBox[{"positions", " ", "of", " ", "D", " ", "sites"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"DhopsL", "[", 
         RowBox[{"[", "whichsites", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Ds", "=", 
        RowBox[{"Ds", "/.", 
         RowBox[{"{", 
          RowBox[{"pos", "\[Rule]", " ", 
           RowBox[{"pos", "-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rate", "=", 
        RowBox[{"RDAL", "[", "whichsites", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Elevels", "=", 
        RowBox[{
         RowBox[{"Tally", "[", "ENm", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlevels", "=", 
        RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
        RowBox[{"SecRates", "[", 
         RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"which", " ", 
          RowBox[{"sector", "?"}]}], ":", " ", 
         RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Rlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", ">", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
            RowBox[{"eta", "\[LessEqual]", "  ", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"whichsec", "=", "i"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "=", 
        RowBox[{"degen", "[", 
         RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"psif", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"UNm", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"update", " ", "Ds"}], ",", " ", 
        RowBox[{"positions", " ", "of", " ", "D", " ", "sites"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"PhihopsR", "[", 
         RowBox[{"[", "whichsites", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Phis", "=", 
        RowBox[{"Phis", "/.", 
         RowBox[{"{", 
          RowBox[{"pos", "\[Rule]", " ", 
           RowBox[{"pos", "+", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rate", "=", 
        RowBox[{"RPhiAR", "[", "whichsites", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Elevels", "=", 
        RowBox[{
         RowBox[{"Tally", "[", "ENm", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlevels", "=", 
        RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
        RowBox[{"SecRates", "[", 
         RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"which", " ", 
          RowBox[{"sector", "?"}]}], ":", " ", 
         RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Rlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", ">", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
            RowBox[{"eta", "\[LessEqual]", "  ", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"whichsec", "=", "i"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "=", 
        RowBox[{"degen", "[", 
         RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"psif", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"UNm", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"update", " ", "Ds"}], ",", " ", 
        RowBox[{"positions", " ", "of", " ", "D", " ", "sites"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"PhihopsL", "[", 
         RowBox[{"[", "whichsites", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Phis", "=", 
        RowBox[{"Phis", "/.", 
         RowBox[{"{", 
          RowBox[{"pos", "\[Rule]", " ", 
           RowBox[{"pos", "-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rate", "=", 
        RowBox[{"RPhiAL", "[", "whichsites", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Elevels", "=", 
        RowBox[{
         RowBox[{"Tally", "[", "ENm", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlevels", "=", 
        RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
        RowBox[{"SecRates", "[", 
         RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"which", " ", 
          RowBox[{"sector", "?"}]}], ":", " ", 
         RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Rlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", ">", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
            RowBox[{"eta", "\[LessEqual]", "  ", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"whichsec", "=", "i"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "=", 
        RowBox[{"degen", "[", 
         RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"psif", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"UNm", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"DPhiR", " ", "and", " ", "DPhiL", " ", "cases"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "5"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"whichsites", " ", "calc", " ", "above", " ", 
        RowBox[{"ignored", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"R", ":", 
         RowBox[{"(", 
          RowBox[{"D", ",", "Phi"}], ")"}]}], ",", " ", 
        RowBox[{"or", " ", 
         RowBox[{"L", ":", 
          RowBox[{"(", 
           RowBox[{"Phi", ",", "D"}], ")"}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "ldpa"}], "}"}], "]"}], "\[LessEqual]", " ", 
          "ldpr"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"whichsites", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "ldpr"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"update", " ", "Ds"}], " ", "&"}], " ", "Phis"}], "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"pos", 
           StyleBox["=",
            FontSize->14], 
           RowBox[{"DPhiR", "[", 
            RowBox[{"[", "whichsites", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Ds", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"Ds", ",", 
             RowBox[{"Position", "[", "pos", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Phis", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"Phis", ",", 
             RowBox[{"Position", "[", 
              RowBox[{"pos", "+", "1"}], "]"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"whichsites", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "ldpl"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"update", " ", "Ds"}], " ", "&"}], " ", "Phis"}], "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"pos", 
           StyleBox["=",
            FontSize->14], 
           RowBox[{"DPhiL", "[", 
            RowBox[{"[", "whichsites", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Ds", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"Ds", ",", 
             RowBox[{"Position", "[", "pos", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Phis", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"Phis", ",", 
             RowBox[{"Position", "[", 
              RowBox[{"pos", "-", "1"}], "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rate", "=", "RDPhiA"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Elevels", "=", 
        RowBox[{
         RowBox[{"Tally", "[", "ENp2mp1", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlevels", "=", 
        RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
        RowBox[{"SecRates", "[", 
         RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"which", " ", 
          RowBox[{"sector", "?"}]}], ":", " ", 
         RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Rlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", ">", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
            RowBox[{"eta", "\[LessEqual]", "  ", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"whichsec", "=", "i"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "=", 
        RowBox[{"degen", "[", 
         RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"psif", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"UNp2mp1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Apairs", " ", "cases"}], ";", " ", 
      RowBox[{"only", " ", "goes", " ", "to", " ", "D"}]}], ",", 
     RowBox[{"Phi", ";", " ", 
      RowBox[{"do", " ", "Phi"}]}], ",", 
     RowBox[{"D", " ", 
      RowBox[{"later", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "6"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "Ds", " ", "and", " ", "Phis"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pos", 
        StyleBox["=",
         FontSize->14], 
        RowBox[{"Apairs", "[", 
         RowBox[{"[", "whichsites", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"Ds", ",", "pos"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"Phis", ",", 
         RowBox[{"pos", "+", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rate", "=", 
        RowBox[{"RDPhiAinv", "[", "whichsites", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Elevels", "=", 
        RowBox[{
         RowBox[{"Tally", "[", "ENm2mm1", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlevels", "=", 
        RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
        RowBox[{"SecRates", "[", 
         RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"which", " ", 
          RowBox[{"sector", "?"}]}], ":", " ", 
         RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Rlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", ">", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
            RowBox[{"eta", "\[LessEqual]", "  ", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"whichsec", "=", "i"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "=", 
        RowBox[{"degen", "[", 
         RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"psif", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"UNm2mm1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"whichjump", "\[Equal]", "7"}], "||", 
       RowBox[{"whichjump", "\[Equal]", "8"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "Ds"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"whichjump", "\[Equal]", "7"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Ds", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{"Ds", ",", 
            RowBox[{"Position", "[", "1", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Ds", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{"Ds", ",", 
            RowBox[{"Position", "[", "Ntot", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Jh", " ", "or", " ", 
         RowBox[{"Jl", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"r5x", "*", "Jh"}]}], " ", ";", 
       RowBox[{"x2", "=", 
        RowBox[{"r6x", "*", "Jl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtot", "=", 
        RowBox[{"x1", "+", "x2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "xtot"}], "}"}], "]"}], "\[LessEqual]", " ", 
          "x1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jh", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", "RCDAh"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENp1mp1", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNp1mp1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jl", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", "RCDAl"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENp1m", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNp1m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"whichjump", "\[Equal]", "9"}], " ", "||", "whichjump"}], "=",
        "10"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "Phis"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"whichjump", "\[Equal]", "9"}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Phis", "=", 
          RowBox[{"Drop", "[", 
           RowBox[{"Phis", ",", 
            RowBox[{"Position", "[", "1", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Phis", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"Phis", ",", 
             RowBox[{"Position", "[", "Ntot", "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"r5", "*", "Jl"}]}], " ", ";", 
       RowBox[{"x2", "=", 
        RowBox[{"r6", "*", "Jh"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtot", "=", 
        RowBox[{"x1", "+", "x2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "xtot"}], "}"}], "]"}], "\[LessEqual]", "  ", 
          "x2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jh", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", "RCDAh"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENp1mp1", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNp1mp1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jl", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", "RCDAl"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENp1m", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNp1m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "11"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "Ds"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"Ds", ",", "1"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Jh", " ", "or", " ", 
         RowBox[{"Jl", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"r9xh", "*", "Jh"}]}], " ", ";", 
       RowBox[{"x2", "=", 
        RowBox[{"r9xl", "*", "Jl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtot", "=", 
        RowBox[{"x1", "+", "x2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "xtot"}], "}"}], "]"}], "\[LessEqual]", " ", 
          "x1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jh", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", 
           RowBox[{"RCAh", "[", "r9i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENm1mm1", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNm1mm1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jl", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", 
           RowBox[{"RCAl", "[", "r9i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENm1m", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNm1m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "12"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "Ds"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"Ds", ",", "Ntot"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Jh", " ", "or", " ", 
         RowBox[{"Jl", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"r10xh", "*", "Jh"}]}], " ", ";", 
       RowBox[{"x2", "=", 
        RowBox[{"r10xl", "*", "Jl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtot", "=", 
        RowBox[{"x1", "+", "x2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "xtot"}], "}"}], "]"}], "\[LessEqual]", " ", 
          "x1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jh", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", 
           RowBox[{"RCAh", "[", "r10i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENm1mm1", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNm1mm1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jl", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", 
           RowBox[{"RCAl", "[", "r10i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENm1m", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNm1m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "13"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "Ds"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"Phis", ",", "1"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Jh", " ", "or", " ", 
         RowBox[{"Jl", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"r11xh", "*", "Jl"}]}], " ", ";", 
       RowBox[{"x2", "=", 
        RowBox[{"r11xl", "*", "Jh"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtot", "=", 
        RowBox[{"x1", "+", "x2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "xtot"}], "}"}], "]"}], "\[LessEqual]", " ", 
          "x2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jh", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", 
           RowBox[{"RCAh", "[", "r11i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENm1mm1", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNm1mm1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jl", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", 
           RowBox[{"RCAl", "[", "r11i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENm1m", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNm1m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "14"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "Ds"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"Phis", ",", "Ntot"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Jh", " ", "or", " ", 
         RowBox[{"Jl", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x1", "=", 
        RowBox[{"r11xh", "*", "Jl"}]}], " ", ";", 
       RowBox[{"x2", "=", 
        RowBox[{"r11xl", "*", "Jh"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtot", "=", 
        RowBox[{"x1", "+", "x2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "xtot"}], "}"}], "]"}], "\[LessEqual]", " ", 
          "x2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jh", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", 
           RowBox[{"RCAh", "[", "r12i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENm1mm1", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNm1mm1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Jl", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rate", "=", 
           RowBox[{"RCAl", "[", "r12i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Elevels", "=", 
           RowBox[{
            RowBox[{"Tally", "[", "ENm1m", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nlevels", "=", 
           RowBox[{"Length", "[", "Elevels", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
           RowBox[{"SecRates", "[", 
            RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"which", " ", 
             RowBox[{"sector", "?"}]}], ":", " ", 
            RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eta", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"Rlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eta", ">", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
               RowBox[{"eta", "\[LessEqual]", "  ", 
                RowBox[{"Rlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"whichsec", "=", "i"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "state"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2"}], "}"}], "=", 
           RowBox[{"degen", "[", 
            RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psif", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"UNm1m", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "kappa", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "15"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rate", "=", "Rkappa"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Elevels", "=", 
        RowBox[{
         RowBox[{"Tally", "[", "ENmm1", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlevels", "=", 
        RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
        RowBox[{"SecRates", "[", 
         RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"which", " ", 
          RowBox[{"sector", "?"}]}], ":", " ", 
         RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Rlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", ">", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
            RowBox[{"eta", "\[LessEqual]", "  ", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"whichsec", "=", "i"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "=", 
        RowBox[{"degen", "[", 
         RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"psif", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"UNmm1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "gamma", "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"whichjump", "\[Equal]", "16"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"update", " ", "the", " ", "wavefunction"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rate", "=", 
        RowBox[{"Rgamma", "[", "whichsites", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"split", " ", "degen", " ", "sectors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Elevels", "=", 
        RowBox[{
         RowBox[{"Tally", "[", "ENmm1", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nlevels", "=", 
        RowBox[{"Length", "[", "Elevels", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rlist", ",", "degen"}], "}"}], "=", 
        RowBox[{"SecRates", "[", 
         RowBox[{"Elevels", ",", "rate"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"which", " ", 
          RowBox[{"sector", "?"}]}], ":", " ", 
         RowBox[{"whichsec", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"eta", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"Rlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", ">", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "&&", 
            RowBox[{"eta", "\[LessEqual]", "  ", 
             RowBox[{"Rlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"whichsec", "=", "i"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "nlevels"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}], "=", 
        RowBox[{"degen", "[", 
         RowBox[{"[", "whichsec", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"psif", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"UNmm1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "All"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i1", "+", "1"}], ",", "i2"}], "}"}]}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7065219637071953`*^9, 3.706522166064768*^9}, {
   3.706522201571206*^9, 3.706522225911521*^9}, {3.706522267128725*^9, 
   3.706522267406897*^9}, {3.706522314421454*^9, 3.70652236874594*^9}, {
   3.706522409661091*^9, 3.706522438435731*^9}, {3.706522495286422*^9, 
   3.70652250831397*^9}, {3.706522562124715*^9, 3.7065226008756447`*^9}, {
   3.706522667606758*^9, 3.706522766672325*^9}, {3.7065228004191437`*^9, 
   3.7065228238303432`*^9}, {3.706522859706849*^9, 3.706522860474001*^9}, {
   3.706522897997829*^9, 3.7065229128595867`*^9}, {3.706522945850152*^9, 
   3.706523024007114*^9}, {3.706523066639839*^9, 3.706523375245776*^9}, {
   3.706533223536619*^9, 3.706533271320971*^9}, {3.70653340539745*^9, 
   3.706533424444952*^9}, {3.706533523200377*^9, 3.706533542353457*^9}, {
   3.706533576547117*^9, 3.7065335901437197`*^9}, {3.706533630545743*^9, 
   3.706533719241219*^9}, {3.7065338159882517`*^9, 3.7065338317537193`*^9}, {
   3.706533886621504*^9, 3.706533986512507*^9}, {3.706534030295383*^9, 
   3.706534163491433*^9}, {3.7065342651566*^9, 3.7065343343605623`*^9}, {
   3.70653436656889*^9, 3.706534444926606*^9}, 3.706534687819682*^9, {
   3.706534718683309*^9, 3.706534803704039*^9}, {3.706534861022381*^9, 
   3.706534897107645*^9}, {3.706534930161367*^9, 3.706535021953474*^9}, {
   3.7065354587256536`*^9, 3.7065355289965763`*^9}, {3.706535560926072*^9, 
   3.706535790762823*^9}, {3.706535821868091*^9, 3.706535822457981*^9}, {
   3.706535888390781*^9, 3.706535966783746*^9}, {3.706536050747068*^9, 
   3.7065360985435677`*^9}, {3.706536180175392*^9, 3.7065362560344257`*^9}, {
   3.7065363269544992`*^9, 3.706536402631831*^9}, 3.706536598533243*^9, {
   3.706536629801238*^9, 3.7065366312247753`*^9}, 3.706536669178203*^9, {
   3.70653670583427*^9, 3.7065367087555513`*^9}, {3.7065374737197657`*^9, 
   3.706537479142933*^9}, {3.706537578499887*^9, 3.7065376013553343`*^9}, {
   3.706537703797658*^9, 3.706537879077636*^9}, {3.70653792435966*^9, 
   3.7065380876273813`*^9}, {3.706538149425873*^9, 3.706538278042261*^9}, {
   3.706538410703453*^9, 3.7065385117805023`*^9}, {3.706538542577291*^9, 
   3.706538549935842*^9}, {3.706538602791669*^9, 3.706538706664455*^9}, {
   3.706538742218978*^9, 3.706538781453212*^9}, {3.706538852450246*^9, 
   3.706538867884637*^9}, {3.706538921230886*^9, 3.7065389278869553`*^9}, {
   3.7065390266928673`*^9, 3.70653905569897*^9}, {3.706539092092684*^9, 
   3.706539261547348*^9}, {3.7065393193918247`*^9, 3.706539352119111*^9}, {
   3.7065393987080727`*^9, 3.706539416473159*^9}, {3.706540234875389*^9, 
   3.7065403559045897`*^9}, {3.706546031978098*^9, 3.706546228573221*^9}, {
   3.706546264368169*^9, 3.7065462689663343`*^9}, {3.70654647660284*^9, 
   3.706546478175881*^9}, {3.706546523723823*^9, 3.7065465589144382`*^9}, {
   3.706546603666391*^9, 3.70654664970372*^9}, {3.70654669612421*^9, 
   3.70654670802754*^9}, {3.706548225411549*^9, 3.706548226145666*^9}, {
   3.706548376489428*^9, 3.706548408060532*^9}, {3.706548465677596*^9, 
   3.706548467188548*^9}, {3.706548497637363*^9, 3.706548511027625*^9}, {
   3.706548593613783*^9, 3.706548633746272*^9}, {3.706548669842435*^9, 
   3.706548718922749*^9}, {3.706548775438208*^9, 3.7065489275993357`*^9}, {
   3.706549450261903*^9, 3.706549876234314*^9}, {3.706549922851948*^9, 
   3.70654994207447*^9}, {3.706550077522922*^9, 3.7065501038814087`*^9}, {
   3.706550221015212*^9, 3.7065504006316223`*^9}, {3.7065504471785517`*^9, 
   3.706550483992337*^9}, {3.7065507504579563`*^9, 3.706550805573945*^9}, {
   3.706550838220072*^9, 3.706550937712717*^9}, {3.7065509848898287`*^9, 
   3.7065510290339947`*^9}, {3.7065510804280376`*^9, 3.706551080962368*^9}, {
   3.706551144621962*^9, 3.706551162509903*^9}, {3.706551234708557*^9, 
   3.7065512659252*^9}, 3.7065513804382343`*^9, {3.706553971928974*^9, 
   3.706554014839252*^9}, {3.706554086289472*^9, 3.706554126365747*^9}, {
   3.706554359123604*^9, 3.706554359576157*^9}, {3.706554391498111*^9, 
   3.706554567526224*^9}, {3.706554675005413*^9, 3.706554771982501*^9}, {
   3.706554824650981*^9, 3.706554866451597*^9}, {3.706554910056404*^9, 
   3.706554926997196*^9}, {3.706555044808076*^9, 3.706555130344335*^9}, {
   3.7065551707169447`*^9, 3.706555196480497*^9}, {3.7065552966753263`*^9, 
   3.706555311347496*^9}, {3.7065554299234467`*^9, 3.706555477861217*^9}, {
   3.706555538107318*^9, 3.706555564172494*^9}, {3.7065556032287827`*^9, 
   3.706555654069351*^9}, {3.706555696571735*^9, 3.7065557005624247`*^9}, {
   3.706555732952176*^9, 3.706555941553438*^9}, {3.706556036442898*^9, 
   3.706556074099379*^9}, {3.706556104616544*^9, 3.706556106197721*^9}, {
   3.7065561364322577`*^9, 3.7065562000822*^9}, {3.706556232221828*^9, 
   3.7065562567293158`*^9}, {3.706556349251326*^9, 3.7065564579279547`*^9}, {
   3.70655651932696*^9, 3.706556524674274*^9}, {3.706556557285714*^9, 
   3.7065566282152567`*^9}, {3.706556663448511*^9, 3.706556679998158*^9}, {
   3.7065568782197647`*^9, 3.706556879993425*^9}, {3.706556921937909*^9, 
   3.706556974742959*^9}, {3.70655701447801*^9, 3.7065570318424263`*^9}, {
   3.7065573080159483`*^9, 3.7065573086067877`*^9}, {3.706557406956375*^9, 
   3.706557433878847*^9}, {3.706557471945632*^9, 3.706557488368258*^9}, {
   3.706557523520076*^9, 3.70655766617274*^9}, {3.706557743707581*^9, 
   3.706557826501801*^9}, {3.706557923798751*^9, 3.7065579739539557`*^9}, {
   3.7065580109109983`*^9, 3.7065580420014772`*^9}, {3.706558080811688*^9, 
   3.706558085491878*^9}, {3.706558189362898*^9, 3.706558220089128*^9}, {
   3.706558258492813*^9, 3.706558305328874*^9}, {3.706558350680862*^9, 
   3.706558364120742*^9}, {3.70655841382778*^9, 3.7065585803183813`*^9}, {
   3.706558621039263*^9, 3.706558647638607*^9}, {3.7065914699616737`*^9, 
   3.7065915667703047`*^9}, {3.706591604252644*^9, 3.706591618583626*^9}, {
   3.7065916758463373`*^9, 3.706591904440152*^9}, {3.706591942114106*^9, 
   3.706592008694145*^9}, {3.706592060792058*^9, 3.7065921580590057`*^9}, {
   3.70659223314762*^9, 3.706592271227981*^9}, {3.706592629126965*^9, 
   3.7065926397374563`*^9}, {3.706593008324532*^9, 3.706593025417597*^9}, {
   3.7065933679282007`*^9, 3.7065934155856447`*^9}, {3.706593446893807*^9, 
   3.706593500344047*^9}, {3.706593534942965*^9, 3.706593561927959*^9}, {
   3.706593606098015*^9, 3.706593638998288*^9}, {3.706594867838963*^9, 
   3.706594868069952*^9}, {3.706594979679009*^9, 3.706594986537071*^9}, {
   3.706595193097224*^9, 3.7065955055293617`*^9}, {3.7065955922795486`*^9, 
   3.706595661313867*^9}, {3.706595707163105*^9, 3.706595737064105*^9}, {
   3.706595975647973*^9, 3.706595986802454*^9}, {3.706596368082736*^9, 
   3.7065963910906363`*^9}, {3.706597124199257*^9, 3.7065972362732983`*^9}, {
   3.7065972943268633`*^9, 3.706597364621914*^9}}]
},
WindowSize->{808, 695},
WindowMargins->{{Automatic, 49}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2188, 55, 267, "Input"],
Cell[2749, 77, 107393, 2657, 12363, "Input"]
}
]
*)

